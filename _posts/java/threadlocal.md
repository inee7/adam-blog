자바 1.2 버전부터 제공되고 있지만 아직 다수의 개발자들이 잘 몰라서 활용을 잘 못하는 기능이 하나 있는데, 그 기능이 바로 쓰레드 단위로 로컬 변수를 할당하는 기능이다.



일반 변수의 수명은 특정 코드 블록\(예, 메서드 범위, for 블록 범위 등\) 범위 내에서만 유효하다.

```java
	{

    int a = 10;

    ...

   // 블록 내에서 a 변수 사용 가능

}

// 변수 a는 위 코드 블록이 끝나면 더 이상 유효하지 않다. \(즉, 수명을 다한다.\)


```



  


반면에 ThreadLocal을 이용하면 쓰레드 영역에 변수를 설정할 수 있기 때문에, 특정 쓰레드가 실행하는 모든 코드에서 그 쓰레드에 설정된 변수 값을 사용할 수 있게 된다. 아래 그림은 쓰레드 로컬 변수가 어떻게 동작하는 지를 간단하게 보여주고 있다.

  


![](data:image/png;base64,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)



ThreadLocal의 기본 사용법

ThreadLocal의 사용방법은 너무 쉽다. 단지 다음의 네 가지만 해 주면 된다.

1. ThreadLocal 객체를 생성한다.
2. ThreadLocal.set\(\) 메서드를 이용해서 현재 쓰레드의 로컬 변수에 값을 저장한다.
3. ThreadLocal.get\(\) 메서드를 이용해서 현재 쓰레드의 로컬 변수 값을 읽어온다.
4. ThreadLocal.remove\(\) 메서드를 이용해서 현재 쓰레드의 로컬 변수 값을 삭제한다.

아래 코드는 ThreadLocal의 기본적인 사용방법을 보여주고 있다.

```java
// 현재 쓰레드와 관련된 로컬 변수를 하나 생성한다.

ThreadLocal<UserInfo> local = new ThreadLocal<UserInfo>();

// 로컬 변수에 값 할당

local.set(currentUser);

// 이후 실행되는 코드는 쓰레드 로컬 변수 값을 사용

UserInfo userInfo = local.get();
```





  

위 코드만으로는 ThreadLocal이 어떻게 동작하는 지 잘 이해가 되지 않을테니, 구체적인 예제를 이용해서 ThreadLocal의 동작 방식을 살펴보도록 하겠다. 먼저 ThreadLocal 타입의 static 필드를 갖는 클래스를 하나 작성해보자.

```java
public class Context {
    public static ThreadLocal<Date> local = new ThreadLocal<Date>();

}


```



  

이제 Context 클래스를 사용해서 쓰레드 로컬 변수를 설정하고 사용하는 코드를 작성할 차례이다. 아래는 코드의 예이다.

```java
class A {

    public void a\(\) {

        Context.local.set\(new Date\(\)\);

        B b = new B\(\);

        b.b\(\);

        Context.local.remove\(\);

    }

}

class B {

    public void b\(\) {

        Date date = Context.local.get\(\);

        C c = new C\(\);

        c.c\(\);

    }

}

class C {

    public void c\(\) {

        Date date = Context.local.get\(\);

    }

}
```





  


위 코드를 보면 A, B, C 세 개의 클래스가 존재하는데, A.a\(\) 메서드를 호출하면 다음 그림과 같은 순서로 메서드가 실행된다.

![](data:image/png;base64,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)

  





위 그림에서 1~10은 모두 하나의 쓰레드에서 실행된다. ThreadLocal과 관련된 부분을 정리하면 다음과 같다.

* 2 - A.a\(\) 메서드에서 현재 쓰레드의 로컬 변수에 Date 객체를 저장한다.
* 4 - B.b\(\) 메서드에서 현재 쓰레드의 로컬 변수에 저장된 Date 객체를 읽어와 사용한다.
* 6 - C.c\(\) 메서드에서 현재 쓰레드의 로컬 변수에 저장된 Date 객체를 읽어와 사용한다.
* 9 - A.a\(\) 메서드에서 현재 쓰레드의 로컬 변수를 삭제한다.

위 코드에서 중요한 건 A.a\(\)에서 생성한 Date 객체를 B.b\(\) 메서드나 C.c\(\) 메서드에 파라미터로 전달하지 않는다는 것이다. 즉, 파라미터로 객체를 전달하지 않아도 한 쓰레드로 실행되는 코드가 동일한 객체를 참조할 수 있게 된다.

ThreadLocal의 활용

ThreadLocal은 한 쓰레드에서 실행되는 코드가 동일한 객체를 사용할 수 있도록 해 주기 때문에 쓰레드와 관련된 코드에서 파라미터를 사용하지 않고 객체를 전파하기 위한 용도로 주로 사용되며, 주요 용도는 다음과 같다.

* 사용자 인증정보 전파 - Spring Security에서는 ThreadLocal을 이용해서 사용자 인증 정보를 전파한다.
* 트랜잭션 컨텍스트 전파 - 트랜잭션 매니저는 트랜잭션 컨텍스트를 전파하는 데 ThreadLocal을 사용한다.
* 쓰레드에 안전해야 하는 데이터 보관

이 외에도 쓰레드 기준으로 동작해야 하는 기능을 구현할 때 ThreadLocal을 유용하게 사용할 수 있다.

ThreadLocal 사용시 주의 사항

쓰레드 풀 환경에서 ThreadLocal을 사용하는 경우 ThreadLocal 변수에 보관된 데이터의 사용이 끝나면 반드시 해당 데이터를 삭제해 주어야 한다. 그렇지 않을 경우 재사용되는 쓰레드가 올바르지 않은 데이터를 참조할 수 있다.

